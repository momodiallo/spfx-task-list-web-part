{"version":3,"sources":["webparts/taskList/TaskListViewModel.ts"],"names":[],"mappings":"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","file":"webparts/taskList/TaskListViewModel.js","sourcesContent":["import * as ko from 'knockout';\r\nimport styles from './TaskList.module.scss';\r\nimport { ITaskListWebPartProps } from './TaskListWebPart';\r\nimport * as moment from 'moment';\r\nimport { Web } from 'sp-pnp-js';\r\nimport { SPComponentLoader } from '@microsoft/sp-loader';\r\nimport * as strings from 'TaskListWebPartStrings';\r\nrequire('./TaskList.scss');\r\nrequire('datatables.net-responsive');\r\nconst $ = require('jquery');\r\n\r\nexport interface ITaskListBindingContext extends ITaskListWebPartProps {\r\n  shouter: KnockoutSubscribable<{}>;\r\n}\r\n\r\nexport interface IListViewHeader {\r\n  Title: string;\r\n}\r\nexport interface IListViewHeaders {\r\n  value: IListViewHeader[];\r\n}\r\n\r\nexport interface IDict {\r\n  key: string;\r\n  value: string;\r\n  url: string;\r\n}\r\n\r\nexport class ISiteUser {\r\n  Id: string;\r\n  UserTitle: string;\r\n}\r\n\r\nexport default class TaskListViewModel {\r\n  public selectedList: KnockoutObservable<string> = ko.observable('');\r\n  public selectedView: KnockoutObservable<string> = ko.observable('');\r\n  private BaseUrl: KnockoutObservable<string> = ko.observable('');\r\n  public viewName: KnockoutObservable<string> = ko.observable('');\r\n  public tblViewName: KnockoutObservable<string> = ko.observable('');\r\n  public listViewID: KnockoutObservable<string> = ko.observable('');\r\n  public listViewHeaders: KnockoutObservableArray<IListViewHeader> = ko.observableArray([]);\r\n  private taskListItems: KnockoutObservableArray<any> = ko.observableArray([]);\r\n  public meetingMinutestypeId: string = \"\";\r\n\r\n  public taskListClass: string = styles.taskList;\r\n  public containerClass: string = styles.container;\r\n  public rowClass: string = styles.row;\r\n  public columnClass: string = styles.column;\r\n  public titleClass: string = styles.title;\r\n  public subTitleClass: string = styles.subTitle;\r\n  public descriptionClass: string = styles.description;\r\n  public buttonClass: string = styles.button;\r\n  public labelClass: string = styles.label;\r\n\r\n  constructor(bindings: ITaskListBindingContext) {\r\n    SPComponentLoader.loadCss(\"https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i\");\r\n    SPComponentLoader.loadCss(\"https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700\");\r\n    SPComponentLoader.loadCss(\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\");\r\n    SPComponentLoader.loadCss('https://cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css');\r\n    SPComponentLoader.loadCss('https://cdn.datatables.net/responsive/2.1.1/css/responsive.dataTables.min.css');\r\n\r\n    this.selectedList(bindings.listTitle);\r\n    this.selectedView(bindings.listViewName);\r\n\r\n    var url = bindings.context.pageContext.web.absoluteUrl;\r\n    this.BaseUrl(url);\r\n\r\n    bindings.shouter.subscribe((value: string) => {\r\n      this.selectedList(value);\r\n    }, this, 'listTitle');\r\n    bindings.shouter.subscribe((value: string) => {\r\n      this.selectedView(value);\r\n    }, this, 'listViewName');\r\n\r\n    // Call of the wild\r\n    if (this.selectedList() && this.selectedList() !== '' && this.selectedView() && this.selectedView() !== '') {\r\n      this.LoadAllSiteUsers();\r\n    }\r\n    else {\r\n      $('#spnMessage').css('display', 'block');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * DisplayListView\r\n   */\r\n  private async DisplayListView(web: Web, listId: string, viewId: string, userColl: Array<ISiteUser>) {\r\n    let contentTypes = await web.contentTypes.select(\"Name, Id/StringValue\").expand(\"Id\").get();\r\n    contentTypes.forEach(contentType => {\r\n      if(contentType[\"Name\"] == \"Meeting Minutes\"){\r\n        this.meetingMinutestypeId = contentType.Id.StringValue;\r\n      }\r\n    });\r\n\r\n    let columnsHeaderFields= [];\r\n    let val = await web.lists.getById(listId).views.getById(viewId).fields.get();\r\n    let viewHeaders = val ? val.Items : val;\r\n    \r\n    if (viewHeaders) {\r\n      viewHeaders.forEach((element: any) => {\r\n        let header: string;\r\n        switch (element) {\r\n          case \"AssignedTo\": header = strings.AssignedTo;\r\n          break;\r\n          case \"DueDate\": header = strings.DueDate;\r\n          break;\r\n          case \"Goedkeuring_budget_aanvragen\": header = strings.Goedkeuring;\r\n          break;\r\n          case \"ID\": header = element;\r\n          break;\r\n          case \"Kostenplaats_x003_kostenplaatsv\": header = strings.Kostenplaats;\r\n          break;  \r\n          case \"OpmerkingBudgetBeheerder\":header = strings.Opmerking;\r\n          break;                  \r\n          case \"LinkTitleNoMenu\": header = strings.LinkTitle;\r\n          break;\r\n          case \"LinkTitle\": header = strings.LinkTitle;\r\n          break;\r\n          case \"Terugkoppeling_x0020_CO\": header = strings.TerugkoppelingCO;\r\n          break;          \r\n          case \"StartDate\": header = strings.StartDate;\r\n          break;\r\n          case \"Status_x0020_WPLU\": header = strings.StatusWPLU;\r\n          break;\r\n          default:\r\n            if (element.split('_x0020_').length > 1) {\r\n              header = element.split('_x0020_').join(\" \");\r\n            } else if (element.split('_').length > 1) {\r\n              header = element.split('_').join(\" \");\r\n            } else {\r\n              header = element;\r\n            }\r\n          break;\r\n        }\r\n        \r\n        let ch: IListViewHeader = {\r\n          Title: header,\r\n        };\r\n        this.listViewHeaders.push(ch);\r\n\r\n        columnsHeaderFields.push(element);\r\n      });\r\n    }\r\n\r\n    let _viewXML: string = \"\";\r\n    let xx = await web.lists.getById(listId).views.getById(viewId).get();\r\n    _viewXML = xx.ListViewXml;\r\n    _viewXML = _viewXML.replace('<FieldRef Name=\"LinkTitleNoMenu\" />', '<FieldRef Name=\"LinkTitle\" />');\r\n\r\n    let items = await web.lists.getById(listId).getItemsByCAMLQuery({ ViewXml: _viewXML });\r\n    items.forEach((element: { [x: string]: any; }) => {\r\n      let itmValue: Array<IDict> = new Array<IDict>();\r\n      columnsHeaderFields.forEach((x,) => {\r\n        switch (x) {\r\n          case \"AssignedTo\":\r\n            //this is to get user info based on user id\r\n            var result = userColl.filter(IUser => IUser.Id == element['AssignedToId']);\r\n            if (result && result.length !== 0) {\r\n              itmValue.push({ key: x, value: result[0]['UserTitle'], url: null });\r\n            }\r\n            else {\r\n              itmValue.push({ key: strings.AssignedTo, value: '', url: null });\r\n            }\r\n            break;\r\n          case \"Predecessors\":\r\n            itmValue.push({ key: x, value: element['PredecessorsId'], url: null });                  \r\n            break;\r\n          case \"WorkflowLink\":\r\n            if(element['WorkflowLink']) {\r\n              itmValue.push({ key: x, value: element['WorkflowLink']['Description'], url: element['WorkflowLink']['Url'] });\r\n            }else {\r\n              itmValue.push({ key: x, value: \"\", url: \"\" });\r\n            }\r\n            break;\r\n          case \"LinkTitle\":\r\n            let actionUrl = \"\";\r\n            if(element[\"ContentTypeId\"] ? element[\"ContentTypeId\"].indexOf(this.meetingMinutestypeId)>-1 : false){\r\n              actionUrl = this.BaseUrl() + '/Lists/Tasks/EditForm.aspx?ID=' + element['Id'] + '&Source=' + this.BaseUrl() + '/SitePages/Dashboard.aspx';\r\n            }\r\n            else{\r\n              actionUrl = this.BaseUrl() + '/_layouts/15/WrkTaskIP.aspx?List=' + this.selectedList() + '&ID=' + element['Id'] + '&Source=' + this.BaseUrl() + '/SitePages/Dashboard.aspx' + '&ContentTypeId=' + element['ContentTypeId'];\r\n            }\r\n            itmValue.push({ key: strings.LinkTitle, value: element['Title'], url: actionUrl });\r\n            break;\r\n          case \"LinkTitleNoMenu\":\r\n            if(element[\"ContentTypeId\"] ? element[\"ContentTypeId\"].indexOf(this.meetingMinutestypeId)>-1 : false){\r\n              actionUrl = this.BaseUrl() + '/Lists/Tasks/EditForm.aspx?ID=' + element['Id'] + '&Source=' + this.BaseUrl() + '/SitePages/Dashboard.aspx';\r\n            }\r\n            else{\r\n              actionUrl = this.BaseUrl() + '/_layouts/15/WrkTaskIP.aspx?List=' + this.selectedList() + '&ID=' + element['Id'] + '&Source=' + this.BaseUrl() + '/SitePages/Dashboard.aspx' + '&ContentTypeId=' + element['ContentTypeId'];\r\n            }\r\n            itmValue.push({ key: strings.LinkTitle, value: element['Title'], url: actionUrl });\r\n            break;\r\n          case \"DueDate\":\r\n            if (element['DueDate']) {\r\n              itmValue.push({ key: strings.DueDate, value: moment(new Date(element['DueDate'])).format(\"DD/MM/YYYY\"), url: null });\r\n            } else {\r\n              itmValue.push({ key: strings.DueDate, value: \"\", url: null });\r\n            }                                  \r\n            break;\r\n          case \"StartDate\":\r\n            if (element['StartDate']) {\r\n              itmValue.push({ key: strings.StartDate, value: moment(new Date(element['StartDate'])).format(\"DD/MM/YYYY\"), url: null });\r\n            } else {\r\n              itmValue.push({ key: strings.StartDate, value: \"\", url: null });\r\n            }                                  \r\n            break;\r\n          default:\r\n            itmValue.push({ key: x, value: element[x], url: null });\r\n            break;\r\n        }\r\n      });\r\n      this.taskListItems.push(itmValue);\r\n    });\r\n\r\n    let tableId: string = '#tbl' + this.tblViewName() + this.listViewID();\r\n    $(tableId).DataTable({\r\n      responsive: true,\r\n      \"lengthMenu\": [[5, 10, 25], [5, 10, 25]],\r\n      initComplete: () => {\r\n      }\r\n    });\r\n    $('#span' + this.tblViewName()).css('display', 'none');\r\n  }\r\n\r\n  /**\r\n   * LoadAllSiteUsers\r\n   */\r\n  public LoadAllSiteUsers() {\r\n    var web = new Web(this.BaseUrl());\r\n\r\n    web.siteUsers.get().then(u => {\r\n      let siteUsersCollection: Array<ISiteUser> = new Array<ISiteUser>();\r\n      u.forEach(el => {\r\n        let iSiteUser: ISiteUser = new ISiteUser();\r\n        iSiteUser.Id = el.Id;\r\n        iSiteUser.UserTitle = el.Title;\r\n        siteUsersCollection.push(iSiteUser);\r\n      });\r\n      return siteUsersCollection;\r\n    }).then(_userColl => {\r\n      let ListID = this.selectedList();\r\n      let ViewID = this.selectedView();\r\n      // get view Name\r\n      web.lists.getById(ListID).views.getById(ViewID).get().then(v => {\r\n        this.viewName(v.Title);\r\n        this.tblViewName(v.Title.replace(/ /g, ''));\r\n        this.listViewID(ViewID);\r\n      });\r\n      //\r\n      this.DisplayListView(web, ListID, ViewID, _userColl);\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}