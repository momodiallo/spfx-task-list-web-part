{"version":3,"sources":["webparts/taskList/TaskListViewModel.ts"],"names":[],"mappings":"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","file":"webparts/taskList/TaskListViewModel.js","sourcesContent":["import * as $ from 'jquery';\r\nimport 'datatables.net-responsive';\r\nimport * as ko from 'knockout';\r\nimport styles from './TaskList.module.scss';\r\nimport { ITaskListWebPartProps } from './TaskListWebPart';\r\nimport pnp, { Web, List, ListEnsureResult, ItemAddResult } from 'sp-pnp-js';\r\nimport { SPComponentLoader } from '@microsoft/sp-loader';\r\nimport { SPHttpClient, SPHttpClientResponse } from '@microsoft/sp-http';\r\nimport * as strings from 'TaskListWebPartStrings';\r\nrequire('./TaskList.scss');\r\n\r\nexport interface ITaskListBindingContext extends ITaskListWebPartProps {\r\n  shouter: KnockoutSubscribable<{}>;\r\n}\r\n\r\nexport interface IListViewHeader {\r\n  Title: string;\r\n}\r\nexport interface IListViewHeaders {\r\n  value: IListViewHeader[];\r\n}\r\n\r\nexport interface IDict {\r\n  key: string;\r\n  value: string;\r\n  url: string;\r\n}\r\n\r\nexport class ISiteUser {\r\n  Id: string;\r\n  UserTitle: string;\r\n}\r\n\r\nexport default class TaskListViewModel {\r\n  public selectedList: KnockoutObservable<string> = ko.observable('');\r\n  public selectedView: KnockoutObservable<string> = ko.observable('');\r\n  private BaseUrl: KnockoutObservable<string> = ko.observable('');\r\n  public viewName: KnockoutObservable<string> = ko.observable('');\r\n  public tblViewName: KnockoutObservable<string> = ko.observable('');\r\n  public listViewHeaders: KnockoutObservableArray<IListViewHeader> = ko.observableArray([]);\r\n  private taskListItems: KnockoutObservableArray<any> = ko.observableArray([]);\r\n  public meetingMinutestypeId: string = \"\";\r\n\r\n  public taskListClass: string = styles.taskList;\r\n  public containerClass: string = styles.container;\r\n  public rowClass: string = styles.row;\r\n  public columnClass: string = styles.column;\r\n  public titleClass: string = styles.title;\r\n  public subTitleClass: string = styles.subTitle;\r\n  public descriptionClass: string = styles.description;\r\n  public buttonClass: string = styles.button;\r\n  public labelClass: string = styles.label;\r\n\r\n  constructor(bindings: ITaskListBindingContext) {\r\n    SPComponentLoader.loadCss(\"https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i\");\r\n    SPComponentLoader.loadCss(\"https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700\");\r\n    SPComponentLoader.loadCss(\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\");\r\n    SPComponentLoader.loadCss('https://cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css');\r\n    SPComponentLoader.loadCss('https://cdn.datatables.net/responsive/2.1.1/css/responsive.dataTables.min.css');\r\n\r\n    this.selectedList(bindings.listTitle);\r\n    this.selectedView(bindings.listViewName);\r\n\r\n    var url = bindings.context.pageContext.web.absoluteUrl;\r\n    this.BaseUrl(url);\r\n\r\n    bindings.shouter.subscribe((value: string) => {\r\n      this.selectedList(value);\r\n    }, this, 'listTitle');\r\n    bindings.shouter.subscribe((value: string) => {\r\n      this.selectedView(value);\r\n    }, this, 'listViewName');\r\n\r\n    // Call of the wild\r\n    if (this.selectedList() && this.selectedList() !== '' && this.selectedView() && this.selectedView() !== '') {\r\n      this.LoadAllSiteUsers();\r\n    }\r\n    else {\r\n      $('#spnMessage').css('display', 'block');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * DisplayListView\r\n   */\r\n  public DisplayListView(web: Web, listId: string, viewId: string, userColl: Array<ISiteUser>) {\r\n    web.contentTypes.select(\"Name, Id/StringValue\").expand(\"Id\").get().then(contentTypes => {\r\n      contentTypes.forEach(contentType => {\r\n        if(contentType[\"Name\"] == \"Meeting Minutes\"){\r\n          this.meetingMinutestypeId = contentType.Id.StringValue;\r\n        }\r\n      });\r\n    });\r\n    web.lists.getById(listId).views.getById(viewId).fields.get().then(val => {\r\n      val.Items.forEach(element => {\r\n        switch (element) {\r\n          case \"MM_x0020_Due_x0020_Date\": element = strings.DueDate;\r\n          break;\r\n          case \"DueDate\": element = strings.DueDate;\r\n          break;\r\n          case \"Goedkeuring_budget_aanvragen\": element = strings.Goedkeuring;\r\n          break;\r\n          case \"OpmerkingBudgetBeheerder\":element = strings.Opmerking;\r\n          break;\r\n          case \"Kostenplaats_x003_kostenplaatsv\": element = strings.Kostenplaats;\r\n          break;\r\n          case \"Status_x0020_WPLU\": element = strings.StatusWPLU;\r\n          break;\r\n          case \"Terugkoppeling_x0020_CO\": element = strings.TerugkoppelingCO;\r\n          break;\r\n          case \"AssignedTo\": element = strings.AssignedTo;\r\n          break;\r\n        }\r\n        let vh: IListViewHeader = {\r\n          Title: element,\r\n        };\r\n        this.listViewHeaders.push(vh);\r\n      });\r\n    }).then(a1=> {\r\n      let webUrl = ko.unwrap(this.BaseUrl());\r\n      let _viewXML: string = \"\";\r\n      web.lists.getById(listId).views.getById(viewId).get().then(xx => {\r\n        _viewXML = xx.ListViewXml;\r\n        _viewXML = _viewXML.replace('<FieldRef Name=\"LinkTitle\" />', '<FieldRef Name=\"LinkTitle\" /><FieldRef Name=\"ContentTypeId\" />');\r\n        if(webUrl.indexOf(\"Executive\")<0 && webUrl.indexOf(\"Director\")<0 && webUrl.indexOf(\"NCC\")<0 && webUrl.indexOf(\"FAP\")<0)\r\n        {\r\n          _viewXML = _viewXML.replace('<FieldRef Name=\"DueDate\" />', '<FieldRef Name=\"DueDate\" /><FieldRef Name=\"MM_x0020_Due_x0020_Date\" />');\r\n        }\r\n      })\r\n      .then(a2 => {\r\n          web.lists.getById(listId).getItemsByCAMLQuery({ ViewXml: _viewXML }).then(items => {\r\n          items.forEach(element => {\r\n            let itmValue: Array<IDict> = new Array<IDict>();\r\n              this.listViewHeaders().forEach(x => {\r\n              if (x.Title == \"AssignedTo\") {\r\n                //this is to get user info based on user id\r\n                var result = userColl.filter(IUser => IUser.Id == element['AssignedToId']);\r\n                if (result && result.length !== 0) {\r\n                  itmValue.push({ key: x.Title, value: result[0]['UserTitle'], url: null });\r\n                }\r\n                else {\r\n                  itmValue.push({ key: x.Title, value: '', url: null });\r\n                }\r\n              }\r\n              else {\r\n                if (x.Title == \"Predecessors\") {\r\n                  itmValue.push({ key: x.Title, value: element['PredecessorsId'], url: null });\r\n                }\r\n                else {\r\n                  if (x.Title == \"WorkflowLink\") {\r\n                    if(element['WorkflowLink']) {\r\n                      itmValue.push({ key: x.Title, value: element['WorkflowLink']['Description'], url: element['WorkflowLink']['Url'] });\r\n                    }else {\r\n                      itmValue.push({ key: x.Title, value: \"\", url: \"\" });\r\n                    }\r\n                  }\r\n                  else {\r\n                    if (x.Title == \"LinkTitle\") {\r\n                      let actionUrl = \"\";\r\n                      if(element[\"ContentTypeId\"] ? element[\"ContentTypeId\"].indexOf(this.meetingMinutestypeId)>-1 : false){\r\n                        actionUrl = this.BaseUrl() + '/Lists/Tasks/EditForm.aspx?ID=' + element['Id'] + '&Source=' + this.BaseUrl() + '/SitePages/Dashboard.aspx';\r\n                      }\r\n                      else{\r\n                        actionUrl = this.BaseUrl() + '/_layouts/15/WrkTaskIP.aspx?List=' + this.selectedList() + '&ID=' + element['Id'] + '&Source=' + this.BaseUrl() + '/SitePages/Dashboard.aspx' + '&ContentTypeId=' + element['ContentTypeId'];\r\n                      }\r\n                      itmValue.push({ key: x.Title, value: element['Title'], url: actionUrl });\r\n                    }\r\n                    else {\r\n                      if (x.Title == \"DueDate\") {\r\n                        var dt;\r\n                        if(element[\"ContentTypeId\"] ? element[\"ContentTypeId\"].indexOf(this.meetingMinutestypeId)>-1 : false) {\r\n                          dt = new Date(element['MM_x0020_Due_x0020_Date']);\r\n                        } else {\r\n                          dt = new Date(element['DueDate']);\r\n                        }\r\n                        itmValue.push({ key: \"Due Date\", value: dt.toDateString(), url: null });\r\n                      }\r\n                      else if(x.Title == \"Due Date\"){\r\n                        dt = new Date(element['MM_x0020_Due_x0020_Date']);\r\n                        itmValue.push({ key: strings.DueDate, value: dt.toDateString(), url: null });\r\n                      }else {\r\n                        itmValue.push({ key: x.Title, value: element[x.Title], url: null });\r\n                      }\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            });\r\n            this.taskListItems.push(itmValue);\r\n          });\r\n          let tableId: string = '#tbl' + this.tblViewName();\r\n          $(tableId).DataTable({\r\n            responsive: true,\r\n            \"lengthMenu\": [[5, 10, 25], [5, 10, 25]],\r\n            initComplete: () => {\r\n            }\r\n          });\r\n          $('#span' + this.tblViewName()).css('display', 'none');\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * LoadAllSiteUsers\r\n   */\r\n  public LoadAllSiteUsers() {\r\n    var web = new Web(this.BaseUrl());\r\n\r\n    web.siteUsers.get().then(u => {\r\n      let siteUsersCollection: Array<ISiteUser> = new Array<ISiteUser>();\r\n      u.forEach(el => {\r\n        let iSiteUser: ISiteUser = new ISiteUser();\r\n        iSiteUser.Id = el.Id;\r\n        iSiteUser.UserTitle = el.Title;\r\n        siteUsersCollection.push(iSiteUser);\r\n      });\r\n      return siteUsersCollection;\r\n    }).then(_userColl => {\r\n      let ListID = this.selectedList();\r\n      let ViewID = this.selectedView();\r\n      // get view Name\r\n      web.lists.getById(ListID).views.getById(ViewID).get().then(v => {\r\n        this.viewName(v.Title);\r\n        this.tblViewName(v.Title.replace(/ /g, ''));\r\n      });\r\n      //\r\n      this.DisplayListView(web, ListID, ViewID, _userColl);\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}